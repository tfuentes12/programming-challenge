<div ng-controller="UserController as ctrl" layout="column" ng-cloak class="md-inline-form">

  <section layout="row" flex>

    <md-sidenav class="md-sidenav-left" md-component-id="left" md-is-locked-open="$mdMedia('gt-xs')" md-whiteframe="4">
      <!-- <md-toolbar class="md-theme-indigo">
        <h1 class="md-toolbar-tools">Sidenav Left</h1>
      </md-toolbar> -->
      <md-content layout-padding>
        <!-- <md-button ng-click="close()" class="md-primary">
          Close Sidenav Left
        </md-button> -->
        <div class="md-media-xl card-media" flex="40" flex-offset="25">
          <img ng-src="http://findicons.com/files/icons/1671/simplicio/128/mail_write.png" class="md-card-image">
        </div>
        <p>
          To-Do:<br>
2. Add autocomplete to any of the recipientâ€™s input fields. Use API
request: /programming_challenge/autocomplete<br>
3. Send the message to the recipient using API request: /programming_challenge/message<br>
4. Show success message if the POST request from step #5 is successful.
        </p>
      </md-content>
    </md-sidenav>

    <md-content flex layout-padding style="background-color: #EEEEEE;">
      <md-card md-theme="{{ showDarkTheme ? 'dark-orange' : 'default' }}" md-theme-watch>
        <md-card-title>
          <md-card-title-text>
            <span class="md-headline">What is your message?</span>
          </md-card-title-text>
        </md-card-title>
        <md-card-content layout="row" layout-align="space-between">
          <div style="width: 100%;">
            <form name="userForm" novalidate>

              <md-autocomplete flex required
                  md-input-name="autocompleteField"
                  md-input-minlength="1"
                  md-input-maxlength="18"
                  md-no-cache="ctrl.noCache"
                  md-selected-item="ctrl.selectedItem"
                  md-search-text="ctrl.searchText"
                  md-items="item in ctrl.querySearch(ctrl.searchText)"
                  md-item-text="item.name"
                  md-floating-label="Name"
                  md-menu-class="autocomplete-custom-template">
                <md-item-template>
                  <span class="item-title">
                    <span><md-icon class="fa fa-user fa-lg" style="color: orange;"></md-icon> {{item.name}}</span>
                  </span>
                  <span class="item-metadata">
                    <span class="item-metastat">
                      <span style="margin-right: 2%;"><md-icon class="fa fa-envelope" style="margin-top: 1%; color: blue;"></md-icon>{{item.email}}</span>
                    </span>
                    <span class="item-metastat">
                      <span><md-icon class="fa fa-phone" style="margin-top: 1%; color: black;"></md-icon>{{item.phone}}</span>
                    </span>
                  </span>
                </md-item-template>
                <p ng-show="userForm.name.$invalid && !userForm.name.$pristine" class="help-block">Name is required.</p>
              </md-autocomplete>

              <div layout="row">
                <md-input-container class="md-block" style="width: 100%;">
                  <label>Name</label>
                  <input type="text" name="name" ng-model="name" required>
                  <p ng-show="userForm.name.$invalid && !userForm.name.$pristine" class="help-block">Name is required.</p>
                </md-input-container>

                <md-input-container class="md-block" flex-offset="5" style="width: 100%;">
                  <label>Email</label>
                  <input type="email" name="email" ng-model="email" ng-pattern="/^.+@.+\..+$/">
                  <p ng-show="userForm.email.$invalid && !userForm.email.$pristine" class="help-block">Enter a valid email.</p>
                  <div style="color: grey;" class="hint" ng-show="(!email.length && sms.length) || (email.length && !sms.length)">Enter an email and/or phone number.</div>
                </md-input-container>

                <md-input-container class="md-block" flex-offset="5" style="width: 100%;">
                  <label>Phone Number</label>
                  <input name="sms" ng-pattern="/^[0-9]{10,11}$/" ng-model="sms">
                  <p ng-show="userForm.sms.$invalid && !userForm.sms.$pristine" class="help-block">Enter a valid number.</p>
                </md-input-container>
              </div>

              <md-input-container class="md-block" style="margin-top: -0.5%;">
                <label>Message</label>
                <textarea ng-model="message" md-maxlength="140" rows="8" md-select-on-focus required></textarea>
              </md-input-container>

              <md-input-container class="md-block">
                <md-button class="md-raised md-primary" ng-disabled="userForm.$invalid">Send</md-button>
              </md-input-container>

            </form>
          </div>

        </md-card-content>
      </md-card>
    </md-content>

  </section>
</div>
